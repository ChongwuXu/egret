var vacIP=["27.115.67.141","27.115.67.225"],payIP=["27.115.67.141","27.115.67.225"],WochengSDK=function(){function k(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml");else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(r){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}return e}function E(e,a,t){var n=k();if(null!=n){d("检查鉴权网络url:"+e),n.open("GET",e,a);var o=setTimeout(function(){n.abort()},1e4);n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status)clearTimeout(o),d("[Get请求成功]"),t(1);else if(r++,r==vacIP.length)d("ip切换结束"),t(0);else{var c=e.replace(vacIP[r-1],vacIP[r]);d(c),E(c,a,t)}},n.send()}}function F(e,r,a){var n=k();if(null!=n){d("检查鉴权网络url:"+e),n.open("GET",e,r);var o=setTimeout(function(){n.abort()},1e4);n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status)clearTimeout(o),d("[Get请求成功]"),a(1);else if(t++,t==vacIP.length)d("ip切换结束"),a(0);else{var c=e.replace(vacIP[t-1],vacIP[t]);d(c),F(c,r,a)}},n.send()}}function G(e,r,a){var t=k();if(null!=t){d("用户订单信息查询url:"+e),t.open("GET",e,r);var n=setTimeout(function(){t.abort()},1e4);t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status)clearTimeout(n),d("[Get请求成功]"),a(1,t.responseText);else if(u++,u==vacIP.length)d("ip切换结束"),a(0,'{"result":0,"errcode":"301"}');else{var o=e.replace(vacIP[u-1],vacIP[u]);d(o),G(o,r,a)}},t.send()}}function J(e,r,a){var t=k();if(null!=t){d("退订url:"+e),t.open("POST",e,r);var n=setTimeout(function(){t.abort()},1e4);t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status)clearTimeout(n),d("[POST请求成功]"),a(1,t.responseText);else if(v++,v==vacIP.length)d("ip切换结束"),a(0,'{"result":0,"errcode":"301"}');else{var o=e.replace(vacIP[v-1],vacIP[v]);d(o),w(o,r,a)}},t.send()}}function w(e,r,a){var t=k();if(null!=t){d("订购记录查询url:"+e),t.open("GET",e,r);var n=setTimeout(function(){t.abort()},1e4);t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status)clearTimeout(n),d("[Get请求成功]"),a(1,t.responseText);else if(p++,p==vacIP.length)d("ip切换结束"),a(0,'{"result":0,"errcode":"301"}');else{var o=e.replace(vacIP[p-1],vacIP[p]);d(o),w(o,r,a)}},t.send()}}function H(e,r,a){var t=k();if(null!=t){d("鉴权url:"+e),t.open("GET",e,r);var n=setTimeout(function(){t.abort()},1e4);t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status)clearTimeout(n),d("[Get请求成功]"),a(1,t.responseText);else if(q++,q==vacIP.length)d("ip切换结束"),a(0,'{"result":0,"errcode":"301"}');else{var o=e.replace(vacIP[q-1],vacIP[q]);d(o),H(o,r,a)}},t.send()}}function z(e,r,a,t){var n=k();if(null!=n){d("计费url："+e),n.open("POST",e,a);var o=setTimeout(function(){n.abort()},1e4);n.onreadystatechange=function(){if(d("发送计费请求 xmlHttp.readyState:"+n.readyState),d("发送计费请求 xmlHttp.status:"+n.status),4==n.readyState)if(200==n.status){clearTimeout(o),d("[发送计费请求post请求成功]");var c=n.responseXML;c.getElementsByTagName("flag")?(x=c.getElementsByTagName("flag")[0].childNodes[0].nodeValue,d("发送计费请求flag :"+x+"--URL:"+e),c="http://payIP:9031/webpay/pay_options".replace(/payIP/,payIP[l])+"?flag="+x,window.location=c):(l++,l==payIP.length?(d("发送计费请求 第一二步都失败 A"),t(0,"out of service")):(c=e.replace(payIP[l-1],payIP[l]),z(c,r,a,t)))}else l++,l==payIP.length?(d("发送计费请求 第一二步都失败 B"),t(0,"out of service")):(c=e.replace(payIP[l-1],payIP[l]),z(c,r,a,t));else t(0,"out of service")},n.send(r)}}function y(b,g,c,a){var e=k();if(null!=e){e.open("POST",b,c);var f=setTimeout(function(){e.abort()},1e4);e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){clearTimeout(f),d("[发送鉴权订单请求post请求成功]");var h=e.responseText;d("OrderProduct响应数据："+h),h=eval("("+h+")"),1==h.result?(d("发送鉴权订单请求:"+h.result),d("发送鉴权订单请求:"+h.orderId),a(1,h.orderId)):(n++,n==vacIP.length?(d("ip切换结束"),a(0,"out of service")):(h=b.replace(vacIP[n-1],vacIP[n]),y(h,g,c,a)))}else n++,n==vacIP.length?(d("ip切换结束"),a(0,"out of service")):(h=b.replace(vacIP[n-1],vacIP[n]),y(h,g,c,a))},e.send(g)}}var l=0,q=0,n=0,p=0,v=0,u=0,r=0,t=0,x,d=function(e){console.log(e)};this.doOrderProduct=function(e,r,a,t,o,c,i,u,p,s,v,f,I,P,h,m,T,g,w,b,k,A){e||(e="unknown"),r||(r="unknown"),a?t?o?c?i?u?(P||(P="unknown"),h||(h="unknown"),m||(m="unknown"),T?g?w?b?k?(d("payVersion:"+T),d("payChannelId:"+g),d("payAppId:"+w),d("payAppName:"+b),d("payUA:"+k),n=0,e="http://vacIP:12324/api/v1.0/buyOrder".replace(/vacIP/,vacIP[n])+"/"+e+"/"+t+"/"+o+"/"+a+"/"+r+"/"+P+"/"+h+"?platform="+m,d("下订单:"+e),y(e,null,!0,function(e,r){1==e?(e='<?xml version="1.0" encoding="UTF-8"?><request><body><Version>'+T+"</Version><ChannelId>"+g+"</ChannelId><AppId>"+w+"</AppId><AppName>"+b+"</AppName><PropName>"+o+"</PropName><PropPrice>"+c+"</PropPrice><ExData>"+r+"</ExData><UA>"+k+"</UA><redirecturl>"+i+"</redirecturl><failurl>"+u+"</failurl><broadbandid>"+p+"</broadbandid><AccessType>url</AccessType><param1>"+a+"</param1><param2>"+s+"</param2><param3>"+v+"</param3><param4>"+f+"</param4><param5>"+I+"</param5></body></request>",d("打开计费页面拼接:"+e),l=0,z("http://payIP:9031/webpay/pay".replace(/payIP/,payIP[l]),e,!0,A)):A(0,"order Product error")})):A(0,"payUA error"):A(0,"payAppName error"):A(0,"payAppId error"):A(0,"payChannelId error"):A(0,"payVersion error")):A(0,"failUrl error"):A(0,"redirectUrl error"):A(0,"price error"):A(0,"contentName error"):A(0,"contentId error"):A(0,"customerId error")},this.doGetProducts=function(e,r,a,t,n,o){if(e)if(r){a||(a=["unknown"]),t||(t="unknown"),n||(n=["unknown"]);for(var c="",i=0;i<a.length;i++)c=i==a.length-1?c+a[i]:c+(a[i]+"-");for(a="",i=0;i<n.length;i++)a=i==n.length-1?a+n[i]:a+(n[i]+"-");q=0,n="http://vacIP:12324/api/v1.0/product".replace(/vacIP/,vacIP[q]),H(n+"?contentId="+e+"&customerId="+r+"&productId="+c+"&userCode="+t+"&productIdThird="+a,!0,o)}else o(0,"customerId error");else o(0,"contentId is empty")},this.doListUserOrders=function(e,r){if(e){p=0;var a="http://vacIP:12324/api/v1.0/order/".replace(/vacIP/,vacIP[p]);w(a+e,!0,r)}else r(0,"customerId error")},this.doUnsubscribe=function(e,r,a,t,n,o){if(e)if(r||(r="unknown"),a){t||(t="unknown"),n||(n="unknown"),v=0;var c="http://vacIP:12324/api/v1.0/manager/unsubscribe/".replace(/vacIP/,vacIP[v]);J(c+e+"/"+a+"/"+r+"/"+t+"/"+n,!0,o)}else o(0,"contentId error");else o(0,"customerId error")},this.doGetOrderInfo=function(e,r,a){if(e)if(r){u=0;var t="http://vacIP:12324/api/v1.0/order/user/".replace(/vacIP/,vacIP[u]);G(t+e+"/"+r,!0,a)}else a(0,"orderId error");else a(0,"customerId error")},this.doZeroOrder=function(e,r,a,t,o,c,i,u,p){e||(e="unknown"),r||(r="unknown"),a?t?o?c?(i||(i="unknown"),u||(u="unknown"),n=0,e="http://vacIP:12324/api/v1.0/buyOrder/zeroJL".replace(/vacIP/,vacIP[n])+"/"+e+"/"+t+"/"+o+"/"+a+"/"+r+"/"+i+"/"+u,d("零元购:"+e),y(e,null,!0,function(e,r){1==e?p(1,"order success"):p(0,"order Product error")})):p(0,"price error"):p(0,"contentName error"):p(0,"contentId error"):p(0,"customerId error")},this.doCheckNetwork=function(e){r=0,E("http://vacIP:12324/api/v1.0/order/111".replace(/vacIP/,vacIP[r]),!0,function(r){1==r?(t=0,F("http://payIP:9031/webpay/serverMonitor".replace(/payIP/,payIP[t]),!0,function(r){1==r?(d("网络正常"),e(1)):e(0)})):e(0)})}};